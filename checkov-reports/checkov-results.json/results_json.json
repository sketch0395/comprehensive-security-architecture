{"check_type": "dockerfile", "results": {"failed_checks": [{"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "FAILED", "results_configuration": null}, "code_block": [[1, "# Use the official Node.js 18 image as base\n"], [2, "FROM node:18-alpine AS base\n"], [3, "\n"], [4, "# Install dependencies only when needed\n"], [5, "FROM base AS deps\n"], [6, "# Check https://github.com/nodejs/docker-node/tree/b4117f9333da4138b03a546ec926ef50a31506c3#nodealpine to understand why libc6-compat might be needed.\n"], [7, "RUN apk add --no-cache libc6-compat\n"], [8, "WORKDIR /app\n"], [9, "\n"], [10, "# Install dependencies based on the preferred package manager\n"], [11, "COPY package.json package-lock.json* ./\n"], [12, "RUN npm ci\n"], [13, "\n"], [14, "# Rebuild the source code only when needed\n"], [15, "FROM base AS builder\n"], [16, "WORKDIR /app\n"], [17, "COPY --from=deps /app/node_modules ./node_modules\n"], [18, "COPY . .\n"], [19, "\n"], [20, "# Next.js collects completely anonymous telemetry data about general usage.\n"], [21, "# Learn more here: https://nextjs.org/telemetry\n"], [22, "# Uncomment the following line in case you want to disable telemetry during the build.\n"], [23, "ENV NEXT_TELEMETRY_DISABLED=1\n"], [24, "\n"], [25, "RUN npm run build\n"], [26, "\n"], [27, "# Production image, copy all the files and run next\n"], [28, "FROM base AS runner\n"], [29, "WORKDIR /app\n"], [30, "\n"], [31, "ENV NODE_ENV=production\n"], [32, "# Uncomment the following line in case you want to disable telemetry during runtime.\n"], [33, "ENV NEXT_TELEMETRY_DISABLED=1\n"], [34, "\n"], [35, "RUN addgroup --system --gid 1001 nodejs\n"], [36, "RUN adduser --system --uid 1001 nextjs\n"], [37, "\n"], [38, "COPY --from=builder /app/public ./public\n"], [39, "\n"], [40, "# Set the correct permission for prerender cache\n"], [41, "RUN mkdir .next\n"], [42, "RUN chown nextjs:nodejs .next\n"], [43, "\n"], [44, "# Automatically leverage output traces to reduce image size\n"], [45, "# https://nextjs.org/docs/advanced-features/output-file-tracing\n"], [46, "COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./\n"], [47, "COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static\n"], [48, "\n"], [49, "USER nextjs\n"], [50, "\n"], [51, "EXPOSE 4000\n"], [52, "\n"], [53, "ENV PORT=4000\n"], [54, "ENV HOSTNAME=\"0.0.0.0\"\n"], [55, "\n"], [56, "# server.js is created by next build from the standalone output\n"], [57, "# https://nextjs.org/docs/pages/api-reference/next-config-js/output\n"], [58, "CMD [\"node\", \"server.js\"]"]], "file_path": "/Dockerfile", "file_abs_path": "/repo/Dockerfile", "repo_file_path": "/repo/Dockerfile", "file_line_range": [1, 58], "resource": "/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images", "details": [], "check_len": null, "definition_context_file_path": null}]}, "summary": {"passed": 152, "failed": 1, "skipped": 0, "parsing_errors": 0, "resource_count": 1, "checkov_version": "3.2.490"}}