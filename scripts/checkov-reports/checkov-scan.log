============================================
[0;34mCheckov Infrastructure-as-Code Security Scan[0m
============================================
Chart Directory: /Users/rnelson/Desktop/CDAO MarketPlace/app/comprehensive-security-architecture/scripts/chart
Output Directory: ./checkov-reports
Chart Name: advana-marketplace
Scan Log: ./checkov-reports/checkov-scan.log
Timestamp: Tue Nov  4 13:26:10 CST 2025

[0;34mğŸ³ Docker and Checkov Information:[0m
Docker version:
Docker version 28.4.0, build d8eb465
Pulling Checkov image...
latest: Pulling from bridgecrew/checkov
Digest: sha256:23120e7037ee12fa696da7905e2a80a4b13189e294ec0fd1f85b2b56f6e3c3d8
Status: Image is up to date for bridgecrew/checkov:latest
docker.io/bridgecrew/checkov:latest

[0;31mâŒ Chart directory not found: /Users/rnelson/Desktop/CDAO MarketPlace/app/comprehensive-security-architecture/scripts/chart[0m
============================================
[0;34mCheckov Infrastructure-as-Code Security Scan[0m
============================================
Chart Directory: /Users/rnelson/Desktop/CDAO MarketPlace/Marketplace/advana-marketplace-monolith-node/chart
Output Directory: ./checkov-reports
Chart Name: advana-marketplace
Scan Log: ./checkov-reports/checkov-scan.log
Timestamp: Wed Nov  5 14:14:18 CST 2025

[0;34mğŸ³ Docker and Checkov Information:[0m
Docker version:
Docker version 28.4.0, build d8eb465
Pulling Checkov image...
latest: Pulling from bridgecrew/checkov
Digest: sha256:23120e7037ee12fa696da7905e2a80a4b13189e294ec0fd1f85b2b56f6e3c3d8
Status: Image is up to date for bridgecrew/checkov:latest
docker.io/bridgecrew/checkov:latest

ğŸ” Step 1: AWS ECR Authentication (Optional)
================================
ğŸ” This chart may require AWS ECR authentication for private dependencies[0m
Options:
  1) Attempt AWS ECR login (recommended for complete analysis)
  2) Skip authentication (fallback to available resources)

Choose option (1 or 2, default: 2): â­ï¸  Skipping AWS authentication - using fallback analysis[0m

ğŸ” Step 2: Helm Dependency Resolution & Template Rendering
================================
[1;33mâš ï¸  Using Docker-based Helm for template rendering[0m
[1;33mâš ï¸  Using Docker-based Helm for template rendering[0m
ğŸ“¦ Resolving Helm chart dependencies...[0m
Chart directory: /Users/rnelson/Desktop/CDAO MarketPlace/Marketplace/advana-marketplace-monolith-node/chart
[1;33mğŸ”“ No AWS ECR authentication - limited dependency resolution[0m
[1;33mâš ï¸  Chart has dependencies - attempting to resolve...[0m
Dependencies found in Chart.yaml:
dependencies:
  - name: advana-library
    version: 2.0.4
    repository: oci://231388672283.dkr.ecr.us-gov-west-1.amazonaws.com/tenant
    tags:
      - library
  - name: postgresql
    version: 15.5.38
    repository: https://charts.bitnami.com/bitnami
    condition: postgresql.enabled
    tags:
      - database
ğŸ“¦ Adding public Helm repositories (timeout: 30s)...[0m
ğŸ“¦ Attempting Docker-based dependency resolution (timeout: 30s)...[0m
[1;33mâš ï¸  Dependencies failed or timed out - continuing with fallback scan[0m
ğŸ’¡ This is expected without AWS ECR access[0m
ğŸ” Attempting to render Helm templates...[0m
Trying Docker-based Helm for template rendering (timeout: 30s)...
[1;33mâš ï¸  Template rendering failed or no resources found[0m
This is common with charts that use private/library charts without authentication
ğŸ”„ Falling back to chart configuration analysis...[0m
[0;32mâœ… Found values.yaml for security analysis[0m
Chart values file size:    10250 bytes
ğŸ“‹ Available for analysis:[0m
  ğŸ“„ Chart.yaml (     473 bytes)
  ğŸ“„ istio-peerauthentication.yaml (     178 bytes)
  ğŸ“„ deployment.yaml (      36 bytes)
  ğŸ“„ pdb.yaml (      29 bytes)
  ğŸ“„ ingress.yaml (      33 bytes)
  ğŸ“„ istio-virtualservice.yaml (     170 bytes)
  ğŸ“„ service.yaml (      33 bytes)
  ğŸ“„ hpa.yaml (      29 bytes)
  ğŸ“„ job.yaml (      29 bytes)
  ğŸ“„ pvc.yaml (      29 bytes)

[0;34mğŸ›¡ï¸  Step 3: Checkov Security Scan[0m
=================================
Scan target: /Users/rnelson/Desktop/CDAO MarketPlace/Marketplace/advana-marketplace-monolith-node/chart
Scan type: helm

Running Checkov security analysis...
Scanning Helm chart values and configuration files...
ğŸ” Scanning values.yaml for security configurations...
{
    "passed": 0,
    "failed": 0,
    "skipped": 0,
    "parsing_errors": 0,
    "resource_count": 0,
    "checkov_version": "3.2.490"
}
{
    "passed": 0,
    "failed": 0,
    "skipped": 0,
    "parsing_errors": 0,
    "resource_count": 0,
    "checkov_version": "3.2.490"
}
ğŸ” Scanning chart directory for security configurations...
{
    "passed": 0,
    "failed": 0,
    "skipped": 0,
    "parsing_errors": 0,
    "resource_count": 0,
    "checkov_version": "3.2.490"
}
{
    "passed": 0,
    "failed": 0,
    "skipped": 0,
    "parsing_errors": 0,
    "resource_count": 0,
    "checkov_version": "3.2.490"
}
Running Checkov security analysis...
{
    "passed": 0,
    "failed": 0,
    "skipped": 0,
    "parsing_errors": 0,
    "resource_count": 0,
    "checkov_version": "3.2.490"
}

============================================
[0;32mâœ… Checkov scan completed successfully![0m
ğŸ‰ No security issues detected!
============================================

[0;34mğŸ”§ Security Recommendations:[0m
=============================
âš ï¸  No results file generated - check scan configuration
âœ… Verify chart templates are valid and accessible
âœ… Check Docker and Checkov image availability

[0;34mğŸ“ Output Files:[0m
================
Scan log: ./checkov-reports/checkov-scan.log
Rendered templates: ./helm-packages/rendered-templates.yaml
Reports directory: ./checkov-reports

[0;34mğŸ”— Related Commands:[0m
====================
Analyze results:     npm run checkov:analyze
Re-run scan:         npm run checkov:scan
Helm build first:    npm run helm:build && npm run checkov:scan
Full security suite: npm run security:scan && npm run virus:scan && npm run checkov:scan

============================================
Checkov security scan complete.
============================================
